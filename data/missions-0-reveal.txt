# Copyright (c) 2025 by ChemtrailOperator
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.

mission "Wormholes 0.1"
	name "Bourne or Bust"
	description "Transport a passenger to Bourne in the Gamma Corvi system."
	passengers 1 
	deadline 21
	destination Bourne
	source
		not attributes uninhabited station
		government
			Republic
			"Free Worlds"
			Syndicate
	to offer
		has "Avgi: First Contact: offered"
		has "First Contact: Bunrodea (Hostile): offered"
		has "Coalition: First Contact: offered"
		has "First Contact: Gegno Vi: offered"
		has "First Contact: Gegno Scin: offered"
		has "First Contact: Hai: offered"
		has "free worlds plot completed"
		has "Ruin: Landing: offered"
		has "First Contact: Quarg: offered"
		has "First Contact: Remnant: offered"
		or
			has "First Contact: Wanderer: offered"
			has "First Contact: Wanderer (Before Hai): offered"
	on offer
		conversation
			`In the <origin> spaceport, you see a man sleeping on a bench with a sign that says: "Bourne or bust."`
			choice
				`	(Wake him up.)`
				`	(Move On.)`
					goto move
			`	It takes a few tries, but finally he wakes up. He sits up, then slides off the bench immediately. You help him up and he begins to speak slowly and precisely; "My sincerest apologies for giving out, but I haven't had sleep in days. I missed my flight back to Bourne two days ago and I haven't been able to make it back. You wouldn't happen to be going that way would you? I can pay you handsomely or I can work on your ship for the passage."`
			`	You notice he has a thick briefcase by his side.`
			choice
				`	"I'll take you for free."`
					goto free
				`	"I'll take on my crew."`
					goto crew
				`	"I'll take you if you can pay."`
					goto pay
				`	"Sorry, I'm not going that way anytime soon."`
					defer
			label free
			`	"Are you sure? It's a long way to Gamma Corvi, and I need to get there without much delay."`
			choice
				`	"On second thought, I'll take your money."`
					goto money
				`	"I don't need your money."`
					goto dontneed
			label money
			`	"Fair enough, I can give you 30,000 credits."`
			choice
				`	"That's fine, you can go get stowed on the <ship>."`
					accept
				`	"No thanks, I'll be on my way."`
					decline
			label dontneed
			`	"Thank you then," He says, "I wish more captains were like you." He leaves to get stowed on the <ship>."`
				accept
			label crew
			`	"Thank you, I can do good work, I used to be an engineer. I will go get stowed without delay."`
				accept
			label pay
			`	"Thank you, I can give you 50,000 credits, but at that price I'd like to go direct." He leaves to get stowed on the <ship>`
				accept
			label move
			`	He'll probably be fine.`
				defer
	on enter "Gamma Corvi"
		payment 30000
		conversation
			`	You got to know the man quite a bit along the way, you even regret a little that your trip is coming to an end so quickly.`
	
mission "Wormholes 0.2"
	landing
	source Bourne
	name "Report to Galactic Command"
	description "Report to Mons in the Olympus system."
	destination Mons
	to offer
		has "Wormholes 0.1: done"
	on offer
		conversation
			`When you've concluded your landing checklists you here a step behind you in the cockpit. You turn around and see your passenger pointing a strange device at you. You sit in stunned silence for a moment before he speaks.`
			`	"Look <last>, I don't know who you are, what you did, or why I'm supposed to do this. I actually kind of like you." He activates the device and a dart launches into your chest. Your vision blurs and begins to swirl as you topple to the floor dramatically.`
			choice
				`	(Fall Unconscious.)`
			choice
				`	(Stay Unconscious.)`
			choice
				`	(Stay Unconscious.)`
			choice
				`	(Stay Unconscious.)`
			`	You should probably wake up now.`
			choice
				`	(Wake Up.)`
			`	You open your eyes to see a tall Hai staring at you. "You are probably feeling a little queasy right now, but that will soon pass. I am sorry we had to take such drastic measures, but there was not another way we could get you here reliably without delay. Do not worry, your ship is secured and it will not come to harm." The Hai speaks slowly and carefully without any trace of an accent. "There is something that is of utmost importance that They would like you to know of. It would be easier for both of us if you could be transferred to a more comfortable area. Can we count on your cooperation?" You notice that there are tight bindings on your arms and legs.`
			choice
				`	"Screw You"`
				`	"I won't try anything."`
					goto freed
			`	Very well, I understand that you must be under a lot of stress right now. We can have our discussion right here.`
				goto talk
			label freed
			`	"Thank you, please wait a moment." The Hai exits the room and reenters a moment later with a key and unlocks the straps holding your arms down.`
			`	"Please follow me" the Hai says."`
			`	You get up and follow the Hai through a door into a large office panelled with a material you can't identify. It gestures you to a seat and begins.`
			label talk
			`	"There are many conflicts in the galaxy going all the time, the Gegno refuse to unite, the Korath will not reconcile soon, even our own Unfettered continue to kill the Wanderers without mercy. Fortunately, most races are separated by gaps insupperable without jump drives, but all get closer to the discovery of the same by the day. Some races are farther than others, like yours, but They have decided that diplomatic channels should be readily available should they be required. They have even managed to ensure cooperation between the Pug and the Quarg, if that gives you any idea of the value placed on this scheme.`
			`	They have organized a great technological masterpiece using an empty system in the far east of the galaxy. It is a ringworld containing wormholes, courtesy of the Pug, to every capital of every civilization. Systems are present or have been created in close proximity to the capitals and they have been hidden by technology that I am proud to say came from the Hai, although the Remnant assisted as well. Your own race has been kind enough to provide the use and knowledge from its massive hyperspace relay system. Even the Gegno, with their rudimentary, even primitive, technology have found a way to contribute.`
			`	Every faction of every civilization is sending delegates to facilitate communication and avoid conflict. This brings us to you. Several in the Free Worlds, as you humans so call it, have recommended you as their chief representative due to your extensive exploration and communication with other species, as well as the fact you are not currently involved in time consuming state duties. There is great responsibility involved, but little real labor, and you will not be hindered much from continuing your life as it is now. Do you accept?"`
			choice
				`	"I have some questions first."`
					goto questions
				`	"Yes."`
					goto yes
				`	"No."`
					goto no
				`	"I'm not sure."`
			`	"If you have any questions I would be happy to answer them."`
			label questions
			choice
				`	"Who are 'They'?"`
					to display
						not "WM who are they"
					goto whoarethey
				`	"How long will this take?"`
					to display
						not "WM how long"
					goto howlong
				`	"Are there any other humans involved?"`
					goto anyother
				`	"Do I get paid?"`
					to display
						not "WM get paid"
					goto getpaid
				`	"Why are you the one telling me this?"`
					to display
						not "WM why you"
					goto whyyou
				`	"Is it dangerous?"`
					to display
						not "WM dangerous"
					goto dangerous
				`	"I'm not sure if I want to do it."`
					goto notsure
				`	"Count me in."`
					goto yes
			label whoarethey
			`	"I thought you would know, They are the Drak, who else?"`
				goto questions
			label anyother
			`	"Yes, quite a few in fact, and we already have multiple delegates from the Republic and the Remnant. Possible delegates from the Deep and the Syndicate are having similar conversations to ours right now."`
				goto questions
			label howlong
			`	"It has already taken many decades, but we are very near completion. There are very few factions still unrepresented."`
				goto questions
			label getpaid
			`	"If you wish."`
				goto questions
			label whyyou
			`	"I am the representative for the peaceful Hai, and the other humans are still being acquainted with the system. They thought it better that something relatively familiar would have a better chance of convincing you."`
				goto questions
			label dangerous
			`	"It can be at times, although that is mostly past."`
				goto questions
			label notsure
			`	"That is understandable. You will have three weeks to decide. If you choose to continue, jump to the system that has been revealed near Gamma Corvi. We will be waiting. Unfortunately this may sting a little." The Hai stands up and pulls a normal taser out of his desk and shoots you in the chest. You wake up an hour later in your ship.`
				accept
			label yes
			`	"Very good. You will find that a system has been revealed near Gamma Corvi. We will be waiting. There are two more things. First, you must only take one ship with you, the gate can only be opened for one from the inside and you must leave any more ships you bring. Secondly, this will probably hurt, but it is necessary." The Hai stands up and pulls a normal taser out of his desk and shoots you in the chest. You wake up an hour later in your ship.`
				accept
			label no
			`	"I am sorry to hear that, but it is your decision to make. This may sting." The Hai stands up and pulls a normal taser out of his desk and shoots you in the chest.`
			`	You wake up in your ship the next day. Everything is normal.`
				decline
	on accept
		event "Reveal Gamma Corvi Route"
	on enter
		mark "Terminal: Gamma Corvi"
	on enter "Terminal: Gamma Corvi"
		unmark "Terminal: Gamma Corvi"
		dialog `A pug ship hails you and instructs you to enter the wormhole.`
	on enter "Hub: Sol"
		dialog `The wormhole takes you to a system that contains a few more wormholes. You only have access to one.`
	on enter "Olympus"
		dialog `You enter the system to see a massive ringworld with a large number of sections that appear to be holding wormholes. You receive a hail telling you to land on the ringworld.`
	on complete
		event "all wormholes revealed"
		outfit "Galactic License"
		conversation	
			`As soon as you step out of your ship you are met by an entourage containing both Pug and Quarg. You are led to a large room filled with an inconceivable variety of colors and shapes. There are at least three of every alien you have met present, and a few that you have never seen before. There seems to be an important discussion going on, but you are hurried past it into an adjoining room. A tall Quarg sitting at a table inside stands and offers you a seat. "Thnak you for joining us today, our system is still in its infancy, but you will help it along its way. You are given full access to all the wormholes we currently operate. We recognize that these systems could very easily be turned into means of war, so each faction has received the right of passage for a single ship, which is not enough to constitute any great danger. To identify yourself and your ship, you will have this.`
			scene "outfit/keystone"
			`	It is a Galactic License, it allows you and your ship to pass through the wormholes and land at this ringworld. You are free to go now. Please explore the systems of wormholes. We may have tasks for you in future."`
	npc
		personality staying forbearing
		government Drak
		ship "Pug Arfecta" "Pug Detail 243"
		system "Terminal: Gamma Corvi"
	npc
		personality staying forbearing
		government Drak
		ship "Pug Arfecta" "Pug Detail 97"
		system "Hub: Sol"
	npc
		personality staying forbearing
		government Drak
		ship "Pug Arfecta" "Pug Detail 12"
		ship "Quarg Wyvern" "Quarg Detail 9"
		ship "Hurricane" "Wanderer Detail 45"
		system destination

event "Reveal Gamma Corvi Route"
	system "Hub: Sol"
		remove hidden
	system "Terminal: Gamma Corvi"
		remove hidden
	system Olympus
		remove hidden

event "all wormholes revealed"
	"reputation: Drak" = 100
	planet "Gate: Sol"
		add attributes "requires: galactic license"
	planet "Gate: Gamma Corvi"
		add attributes "requires: galactic license"
	system "Hub: Ya Hai"
		remove hidden
	system "Hub: Ki War Ek"
		remove hidden
	system "Hub: Concerto"
		remove hidden
	system "Hub: Erabu Lemeta"
		remove hidden
	system "Hub: Heutesl"
		remove hidden
	system "Hub: Ka'ch'chrai"
		remove hidden
	system "Hub: Kashikt"
		remove hidden
	system "Terminal: Gamma Corvi"
		remove object "Gate: Gamma Corvi Unlocked"
			sprite planet/jumpring
				scale 0.5
			distance 812
			period 349.820
			offset 260
		add object "Gate: Gamma Corvi"
			sprite planet/jumpring
				scale 0.5
			distance 812
			period 349.820
			offset 260
	system "Terminal: Epsilon Leonis"
		remove hidden
	system "Terminal: Arculus"
		remove hidden
	system "Terminal: Markab"
		remove hidden
	system "Terminal: Wah Yoot"
		remove hidden
	system "Terminal: Sol Kimek"
		remove hidden
	system "Terminal: Sol Saryd"
		remove hidden
	system "Terminal: Sol Arach"
		remove hidden
	system "Terminal: Mego Inito"
		remove hidden
	system "Terminal: Zeinar"
		remove hidden
	system "Terminal: Kaliptari"
		remove hidden
